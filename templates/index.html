<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Driver Data Map</title>
    <link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css" />
    <style>
        #map {
            height: 600px;
            width: 100%;
        }
    </style>
    <script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>
</head>
<body>
    <h1>Driver Data Map</h1>
    <div id="map"></div>
    <script>
        // Create a map centered around a specific location
        var myMap = L.map('map').setView([0, 0], 2);

        // Add a tile layer for the map
        L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
            attribution: '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'
        }).addTo(myMap);

        // Fetch driver data from the Flask endpoint
        var url = 'http://127.0.0.1:5000/driver_data';
        fetch(url)
            .then(response => response.json())
            .then(data => {
                // Loop through the driver data and create markers
                data.forEach(driver => {
                    var latitude = driver[6];  // Replace with the actual field name for latitude
                    var longitude = driver[7];  // Replace with the actual field name for longitude
                    var name = driver[1];  // Replace with the actual field name for driver name
                    var team = driver[2];  // Replace with the actual field name for team

                    // Create a marker for each driver
                    L.marker([latitude, longitude])
                        .bindPopup(`<b>Driver:</b> ${name}<br><b>Team:</b> ${team}`)
                        .addTo(myMap);
                });

                // // Optionally, fit the map to the markers
                // var bounds = data.map(driver => [driver.latitude, driver.longitude]);
                // myMap.fitBounds(bounds);
            })
            .catch(error => console.error('Error fetching data:', error));
    </script>
</body>
</html>